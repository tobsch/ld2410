substitutions:
  devicename: base
  friendly: Presence Detector
  board: esp32-c3-devkitm-1
  wifi_ssid: !secret wifi_ssid
  wifi_password: !secret wifi_password
  fallback_ap_password: !secret wifi_password
  ld_uart_tx: GPIO21
  ld_uart_rx: GPIO20
  ld_baud: "256000"

esphome:
  name: ${devicename}
  friendly_name: ${friendly}
  min_version: 2025.5.0
  name_add_mac_suffix: false

esp32:
  board: ${board}
  framework:
    type: esp-idf

logger:

api:
  encryption:
    key: !secret ha_api_key

# Bluetooth Proxy
esp32_ble_tracker:
  scan_parameters:
    interval: 1100ms
    window: 300ms
    active: true

bluetooth_proxy:
  active: true

ota:
  - platform: esphome
    password: ${ota_password}

wifi:
  ssid: ${wifi_ssid}
  password: ${wifi_password}
  ap:
    ssid: "${friendly} Fallback"
    password: ${fallback_ap_password}

captive_portal:

uart:
  id: uart_bus
  tx_pin: ${ld_uart_tx}
  rx_pin: ${ld_uart_rx}
  baud_rate: ${ld_baud}

ld2410:
  uart_id: uart_bus

binary_sensor:
  - platform: ld2410
    has_target:
      name: "${friendly} Target Detected"

sensor:
  - platform: ld2410
    detection_distance:
      name: "${friendly} Detection Distance"

  # Diagnostic sensors
  - platform: wifi_signal
    name: "${friendly} WiFi Signal"
    update_interval: 60s

  - platform: uptime
    name: "${friendly} Uptime"
    update_interval: 60s

  - platform: internal_temperature
    name: "${friendly} Internal Temperature"
    update_interval: 60s

text_sensor:
  - platform: wifi_info
    ip_address:
      name: "${friendly} IP Address"
    ssid:
      name: "${friendly} Connected SSID"

  - platform: version
    name: "${friendly} ESPHome Version"

button:
  - platform: restart
    name: "${friendly} Restart"

  - platform: safe_mode
    name: "${friendly} Safe Mode"
